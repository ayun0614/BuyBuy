<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ezen.buybuy.mapper.AlertMapper">
	<select id="Login"
		parameterType="com.ezen.buybuy.entity.Members"
		resultType="com.ezen.buybuy.entity.Members">
		select* from members where member_id=#{member_id}
	</select>
	<select id="AlertList" resultType="com.ezen.buybuy.entity.Alert">
		select * from alert where
		member_id=#{member_id} order by a_idx desc
	</select>
	<update id="alertUpdate"
		parameterType="com.ezen.buybuy.entity.Alert">
		update alert set a_state=0 where a_idx=#{a_idx} and
		member_id=#{member_id};
	</update>

	<insert id="replyalert" parameterType="com.ezen.buybuy.entity.Alert" >
		insert into
		alert(a_title,msg,member_id,a_url,a_state,product_idx)
		values('댓글','달렸습니다',(select DISTINCT p.member_id from reply as r inner join products as p on
		r.product_idx=p.product_idx
		where r.member_id=#{member_id} LIMIT 1),'alertUpdate',1,#{product_idx});
	</insert>
	
	<insert id="reply2alert" parameterType="com.ezen.buybuy.entity.Alert" >
		insert into
		alert(a_title,msg,member_id,a_url,a_state,product_idx)
		values('답변','달렸습니다',(select DISTINCT member_id from reply2 where reply_idx=#{reply_idx}),'alertUpdate',1,#{product_idx});
	</insert>

	<insert id="orderalert">

	</insert>
</mapper>